# åé¦ˆæµç¨‹è¯´æ˜

## ç”¨æˆ·åé¦ˆæµç¨‹

### 1. ç”¨æˆ·ç•Œé¢

ç”¨æˆ·åœ¨è·¯çº¿æ¨èå¡ç‰‡ä¸Šçœ‹åˆ°ï¼š
- **"View Details"** æŒ‰é’®
- **"ğŸ‘ ä¸å–œæ¬¢"** æŒ‰é’®ï¼ˆThumbsDownå›¾æ ‡ï¼‰

### 2. ç‚¹å‡»"ä¸å–œæ¬¢"æŒ‰é’®

å½“ç”¨æˆ·ç‚¹å‡»"ä¸å–œæ¬¢"æŒ‰é’®æ—¶ï¼Œä¼šå¼¹å‡ºè¯¦ç»†çš„åé¦ˆå¯¹è¯æ¡†ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Help us improve              [X]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  What didn't you like about          â”‚
â”‚  "Route Name"? Your feedback helps   â”‚
â”‚  us provide better recommendations.  â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ’ª Too Difficult             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ˜´ Too Easy                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸš— Too Far                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ¤· Not Interested             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                     â”‚
â”‚  [Cancel]        [Submit Feedback]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. åé¦ˆé€‰é¡¹æ˜ å°„

ç”¨æˆ·é€‰æ‹©çš„åé¦ˆåŸå› ä¼šè¢«æ˜ å°„åˆ°ç®—æ³•è°ƒæ•´ï¼š

| ç”¨æˆ·é€‰æ‹© | åé¦ˆåŸå›  | ç®—æ³•è°ƒæ•´ |
|---------|---------|---------|
| ğŸ’ª Too Difficult | `too-hard` | é™ä½æœ€å¤§éš¾åº¦åå¥½ |
| ğŸ˜´ Too Easy | `too-easy` | æé«˜æœ€å°éš¾åº¦åå¥½ |
| ğŸš— Too Far | `too-far` | å‡å°‘æœ€å¤§è·ç¦»åå¥½ |
| ğŸ¤· Not Interested | `not-interested` | ç§»é™¤ä¸æ„Ÿå…´è¶£çš„æ ‡ç­¾ |

### 4. åç«¯å¤„ç†

#### 4.1 ä¿å­˜åé¦ˆ

åé¦ˆè¢«ä¿å­˜åˆ°æ•°æ®åº“ï¼š
```python
ProfileFeedback(
    demo_profile_id=user_id,
    route_id=route_id,
    reason="too-hard"  # ç”¨æˆ·é€‰æ‹©çš„åŸå› 
)
```

#### 4.2 è°ƒæ•´ç”¨æˆ·åå¥½å‘é‡

ç®—æ³•æ ¹æ®åé¦ˆè°ƒæ•´ç”¨æˆ·åå¥½ï¼š

```python
# ç¤ºä¾‹ï¼šç”¨æˆ·åé¦ˆ"too-hard"
if feedback.reason == "too-hard":
    # é™ä½æœ€å¤§éš¾åº¦åå¥½
    user_vector["difficulty_range"][1] -= 0.5
    # ä» [1, 3] è°ƒæ•´ä¸º [1, 2.5]
```

#### 4.3 åº”ç”¨åé¦ˆæƒ©ç½š

å¯¹åé¦ˆè¿‡çš„è·¯çº¿åº”ç”¨æƒ©ç½šï¼š
```python
# 1æ¬¡åé¦ˆï¼šé™ä½åˆ°5%
# 2æ¬¡åé¦ˆï¼šé™ä½åˆ°1%
# 3æ¬¡åé¦ˆï¼šå®Œå…¨è¿‡æ»¤
```

## å®Œæ•´æµç¨‹ç¤ºä¾‹

### åœºæ™¯ï¼šç”¨æˆ·è§‰å¾—è·¯çº¿å¤ªéš¾

1. **ç”¨æˆ·æ“ä½œ**ï¼š
   - çœ‹åˆ°è·¯çº¿æ¨è
   - ç‚¹å‡»"ğŸ‘ ä¸å–œæ¬¢"
   - é€‰æ‹©"ğŸ’ª Too Difficult"
   - ç‚¹å‡»"Submit Feedback"

2. **å‰ç«¯å¤„ç†**ï¼š
   ```typescript
   handleFeedbackSubmit("too-hard")
   â†’ apiClient.submitFeedback(profileId, routeId, "too-hard")
   ```

3. **åç«¯ä¿å­˜**ï¼š
   ```python
   ProfileFeedback(
       demo_profile_id=1,
       route_id=123,
       reason="too-hard"
   )
   ```

4. **ç®—æ³•è°ƒæ•´**ï¼ˆä¸‹æ¬¡æ¨èæ—¶ï¼‰ï¼š
   ```python
   # åŸå§‹åå¥½
   user_vector = {
       "difficulty_range": [1, 3],
       "max_distance_km": 20.0,
       "preferred_tags": ["mountain"]
   }
   
   # è°ƒæ•´ååå¥½
   adjusted_vector = {
       "difficulty_range": [1, 2.5],  # æœ€å¤§éš¾åº¦é™ä½
       "max_distance_km": 20.0,
       "preferred_tags": ["mountain"]
   }
   ```

5. **æ¨èç»“æœ**ï¼š
   - è¯¥è·¯çº¿è¢«æƒ©ç½šï¼ˆåˆ†æ•°é™ä½åˆ°5%ï¼‰
   - æœªæ¥æ¨èæ›´å€¾å‘äºéš¾åº¦è¾ƒä½çš„è·¯çº¿
   - ç”¨æˆ·åå¥½å‘é‡å·²æ›´æ–°

## ä»£ç ä½ç½®

### å‰ç«¯
- **åé¦ˆå¯¹è¯æ¡†**: `frontend/components/feedback-dialog.tsx`
- **åé¦ˆå¤„ç†**: `frontend/components/route-recommendations.tsx` (line 283-339)
- **APIè°ƒç”¨**: `frontend/lib/api-client.ts` (submitFeedbackæ–¹æ³•)

### åç«¯
- **åé¦ˆAPI**: `backend/app/api/v1/profiles.py` (POST /api/profiles/{id}/feedback)
- **æ¨èç®—æ³•**: `backend/app/services/recommendation_service.py`
  - `adjust_user_vector_with_feedback()` - è°ƒæ•´ç”¨æˆ·åå¥½
  - `calculate_feedback_penalty()` - è®¡ç®—åé¦ˆæƒ©ç½š
  - `get_recommended_routes()` - è·å–æ¨èï¼ˆé›†æˆåé¦ˆï¼‰

## æ€»ç»“

âœ… **å‰ç«¯å·²æœ‰è¯¦ç»†åé¦ˆé€‰é¡¹** - ç”¨æˆ·å¯ä»¥é€‰æ‹©4ç§ä¸åŒçš„åé¦ˆåŸå› 

âœ… **ç®—æ³•æ­£ç¡®ä½¿ç”¨åé¦ˆ** - æ ¹æ®åé¦ˆåŸå› è°ƒæ•´ç”¨æˆ·åå¥½å‘é‡

âœ… **å®Œæ•´æµç¨‹å·²å®ç°** - ä»ç”¨æˆ·ç‚¹å‡»åˆ°ç®—æ³•è°ƒæ•´çš„å®Œæ•´é“¾è·¯

ç”¨æˆ·çœ‹åˆ°çš„"ğŸ‘ ä¸å–œæ¬¢"æŒ‰é’®è™½ç„¶çœ‹èµ·æ¥ç®€å•ï¼Œä½†ç‚¹å‡»åä¼šå¼¹å‡ºè¯¦ç»†çš„åé¦ˆå¯¹è¯æ¡†ï¼Œè®©ç”¨æˆ·é€‰æ‹©å…·ä½“åŸå› ã€‚è¿™äº›è¯¦ç»†åé¦ˆä¼šè¢«ç®—æ³•ç”¨æ¥æ™ºèƒ½zai a

